在处理器有电时，程序计数器会根据一个全是指令地址的序列去依次执行指令，这个过程称为 **控制转移（control transfer）**，这样的序列称为处理器的 **控制器（control flow）**。

正常情况下，控制流是线性的，但是程序自身逻辑导致的跳转、调用、返回会造成正常控制流的 “突变”（），同时，系统事件也会打断控制流：硬件定时器、网络包到达、磁盘 I/O 完成、子进程退出等事件，都必须使 CPU 停下当前执行，转去处理这些事件。

把这些来自系统状态变化的突变统称为 **异常控制流（Exceptional Control Flow，ECF）**。ECF 在系统各层都存在：
- **硬件层**：中断、异常 → 转到异常处理程序；
- **操作系统层**：内核执行进程切换；
- **应用层**：进程之间的信号、非本地跳转（来对错误做出反应）；

**程序员必须理解 ECF 的原因：**
- 理解 OS 内部机制（I/O、进程、虚拟内存）的基础；
- 解释了应用程序如何通过系统调用与操作系统交互；
- 创建 shell、Web 服务器等系统级应用的必备知识；
- 并发的根机制（中断、线程、进程、信号）；
- 帮助理解高级语言的异常机制（try/catch）是如何构建的；

---
# 8.1 异常
异常是异常控制流的一种形式，一部分由硬件实现，一部分由操作系统实现。因为有一部分是由硬件实现的，所以具体细节将随系统的不同而有所不同，但是基本思想都是相同的。

异常本质上就是：CPU 在执行某条指令时遇到某个事件 → 立刻强制跳到 OS 的异常处理程序 → 处理完再决定跳回哪里或是否终止程序。如图 8.1 展示了基本的思想。
